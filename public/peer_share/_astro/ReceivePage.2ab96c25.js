import{S as me,i as _e,s as he,x as F,a as L,z as H,f as B,A as U,h as I,B as R,C as N,d as p,D as Q,G,H as ae,I as oe,J as be,K as ge,e as k,t as fe,c as E,b as A,y as te,k as ue,g as b,j as P,l as W,E as pe,p as ie,n as re}from"./toastStore.64ab63c7.js";import{C as X,d as le,i as $e,M as ve,a as we,b as Ce,e as ke,f as ce,w as Ee,S as De,R as Se,E as Pe,h as Te,Q as ye,k as Oe}from"./QrModal.a4898c7b.js";function Ie(r){let t,s='<span class="loading loading-spinner loading-lg"></span> <div>Generating Pairing Key</div>';return{c(){t=k("div"),t.innerHTML=s,this.h()},l(n){t=E(n,"DIV",{class:!0,"data-svelte-h":!0}),te(t)!=="svelte-140r8rr"&&(t.innerHTML=s),this.h()},h(){b(t,"class","flex flex-col items-center justify-center gap-2")},m(n,o){I(n,t,o)},p:re,i:re,o:re,d(n){n&&p(t)}}}function Ae(r){let t,s=`Copy and send the Pairing Key or scan QR code to connect between peer. See
        <a class="link" href="${Oe+"#how-does-it-work"}" target="_blank" rel="noopener noreferrer">How does it work?</a>`,n,o,e,a,f,l,h,w,D,g,C,K,O,T,$,S,V;h=new Pe({props:{onChange:r[16]}}),C=new Te({});let j={qrData:r[4],title:"Pairing Key QR Code"};return T=new ye({props:j}),r[17](T),{c(){t=k("p"),t.innerHTML=s,n=L(),o=k("div"),e=k("input"),f=L(),l=k("div"),F(h.$$.fragment),w=L(),D=k("div"),g=k("button"),F(C.$$.fragment),K=fe("Copy Pairing Key"),O=L(),F(T.$$.fragment),this.h()},l(i){t=E(i,"P",{"data-svelte-h":!0}),te(t)!=="svelte-104hzz8"&&(t.innerHTML=s),n=B(i),o=E(i,"DIV",{class:!0});var c=A(o);e=E(c,"INPUT",{type:!0,class:!0}),f=B(c),l=E(c,"DIV",{class:!0});var v=A(l);H(h.$$.fragment,v),v.forEach(p),c.forEach(p),w=B(i),D=E(i,"DIV",{class:!0});var d=A(D);g=E(d,"BUTTON",{class:!0});var J=A(g);H(C.$$.fragment,J),K=ue(J,"Copy Pairing Key"),J.forEach(p),O=B(d),H(T.$$.fragment,d),d.forEach(p),this.h()},h(){b(e,"type",a=r[5]?"text":"password"),b(e,"class","input input-bordered w-full"),e.value=r[4],e.readOnly=!0,b(l,"class","absolute top-0 right-0 p-1"),b(o,"class","relative mt-4"),b(g,"class","btn btn-primary gap-2"),b(D,"class","mt-4 flex gap-2")},m(i,c){I(i,t,c),I(i,n,c),I(i,o,c),P(o,e),P(o,f),P(o,l),U(h,l,null),I(i,w,c),I(i,D,c),P(D,g),U(C,g,null),P(g,K),P(D,O),U(T,D,null),$=!0,S||(V=W(g,"click",r[14]),S=!0)},p(i,c){(!$||c[0]&32&&a!==(a=i[5]?"text":"password"))&&b(e,"type",a),(!$||c[0]&16&&e.value!==i[4])&&(e.value=i[4]);const v={};c[0]&32&&(v.onChange=i[16]),h.$set(v);const d={};c[0]&16&&(d.qrData=i[4]),T.$set(d)},i(i){$||(R(h.$$.fragment,i),R(C.$$.fragment,i),R(T.$$.fragment,i),$=!0)},o(i){N(h.$$.fragment,i),N(C.$$.fragment,i),N(T.$$.fragment,i),$=!1},d(i){i&&(p(t),p(n),p(o),p(w),p(D)),Q(h),Q(C),r[17](null),Q(T),S=!1,V()}}}function Re(r){let t,s,n,o;const e=[Ae,Ie],a=[];function f(l,h){return l[4]?0:1}return t=f(r),s=a[t]=e[t](r),{c(){s.c(),n=oe()},l(l){s.l(l),n=oe()},m(l,h){a[t].m(l,h),I(l,n,h),o=!0},p(l,h){let w=t;t=f(l),t===w?a[t].p(l,h):(be(),N(a[w],1,1,()=>{a[w]=null}),ge(),s=a[t],s?s.p(l,h):(s=a[t]=e[t](l),s.c()),R(s,1),s.m(n.parentNode,n))},i(l){o||(R(s),o=!0)},o(l){N(s),o=!1},d(l){l&&p(n),a[t].d(l)}}}function Ne(r){let t,s;return t=new X({props:{title:"1. Accept Connection",isOpen:!r[12],$$slots:{default:[Re]},$$scope:{ctx:r}}}),{c(){F(t.$$.fragment)},l(n){H(t.$$.fragment,n)},m(n,o){U(t,n,o),s=!0},p(n,o){const e={};o[0]&4096&&(e.isOpen=!n[12]),o[0]&1072|o[1]&8&&(e.$$scope={dirty:o,ctx:n}),t.$set(e)},i(n){s||(R(t.$$.fragment,n),s=!0)},o(n){N(t.$$.fragment,n),s=!1},d(n){Q(t,n)}}}function Ke(r){let t,s,n,o="Send",e,a,f,l,h,w,D,g,C,K="Receive",O,T,$,S,V,j,i,c,v,d,J,se={dataChannel:r[13],rsaPub:r[3],isEncrypt:r[0],chunkSize:r[1]};S=new De({props:se}),r[20](S);let ne={dataChannel:r[13],isEncrypt:r[0],rsa:r[2]};return c=new Se({props:ne}),r[21](c),{c(){t=k("div"),s=k("button"),n=k("span"),n.textContent=o,a=L(),f=k("div"),l=k("span"),h=fe("New files"),D=L(),g=k("button"),C=k("span"),C.textContent=K,T=L(),$=k("div"),F(S.$$.fragment),j=L(),i=k("div"),F(c.$$.fragment),this.h()},l(u){t=E(u,"DIV",{class:!0});var m=A(t);s=E(m,"BUTTON",{class:!0});var q=A(s);n=E(q,"SPAN",{class:!0,"data-svelte-h":!0}),te(n)!=="svelte-3upt3h"&&(n.textContent=o),q.forEach(p),a=B(m),f=E(m,"DIV",{class:!0});var M=A(f);l=E(M,"SPAN",{class:!0});var Y=A(l);h=ue(Y,"New files"),Y.forEach(p),D=B(M),g=E(M,"BUTTON",{class:!0});var Z=A(g);C=E(Z,"SPAN",{class:!0,"data-svelte-h":!0}),te(C)!=="svelte-1rs7wsw"&&(C.textContent=K),Z.forEach(p),M.forEach(p),m.forEach(p),T=B(u),$=E(u,"DIV",{});var x=A($);H(S.$$.fragment,x),x.forEach(p),j=B(u),i=E(u,"DIV",{});var ee=A(i);H(c.$$.fragment,ee),ee.forEach(p),this.h()},h(){b(n,"class","btm-nav-label"),b(s,"class",e="btn "+(r[8]?"btn-primary":"btn-ghost")+" flex-grow border-black border-dotted"),b(l,"class",w="indicator-item badge badge-accent animate-bounce "+(r[9]?"block":"hidden")),b(C,"class","btm-nav-label"),b(g,"class",O="btn "+(r[8]?"btn-ghost":"btn-primary")+" w-full border-black border-dotted"),b(f,"class","indicator flex-grow"),b(t,"class","flex w-full mb-4 mt-2"),$.hidden=V=!r[8],i.hidden=r[8]},m(u,m){I(u,t,m),P(t,s),P(s,n),P(t,a),P(t,f),P(f,l),P(l,h),P(f,D),P(f,g),P(g,C),I(u,T,m),I(u,$,m),U(S,$,null),I(u,j,m),I(u,i,m),U(c,i,null),v=!0,d||(J=[W(s,"click",r[18]),W(g,"click",r[19])],d=!0)},p(u,m){(!v||m[0]&256&&e!==(e="btn "+(u[8]?"btn-primary":"btn-ghost")+" flex-grow border-black border-dotted"))&&b(s,"class",e),(!v||m[0]&512&&w!==(w="indicator-item badge badge-accent animate-bounce "+(u[9]?"block":"hidden")))&&b(l,"class",w),(!v||m[0]&256&&O!==(O="btn "+(u[8]?"btn-ghost":"btn-primary")+" w-full border-black border-dotted"))&&b(g,"class",O);const q={};m[0]&8192&&(q.dataChannel=u[13]),m[0]&8&&(q.rsaPub=u[3]),m[0]&1&&(q.isEncrypt=u[0]),m[0]&2&&(q.chunkSize=u[1]),S.$set(q),(!v||m[0]&256&&V!==(V=!u[8]))&&($.hidden=V);const M={};m[0]&8192&&(M.dataChannel=u[13]),m[0]&1&&(M.isEncrypt=u[0]),m[0]&4&&(M.rsa=u[2]),c.$set(M),(!v||m[0]&256)&&(i.hidden=u[8])},i(u){v||(R(S.$$.fragment,u),R(c.$$.fragment,u),v=!0)},o(u){N(S.$$.fragment,u),N(c.$$.fragment,u),v=!1},d(u){u&&(p(t),p(T),p($),p(j),p(i)),r[20](null),Q(S),r[21](null),Q(c),d=!1,pe(J)}}}function Me(r){let t,s,n,o,e;return{c(){t=k("div"),s=k("div"),n=k("textarea"),this.h()},l(a){t=E(a,"DIV",{class:!0});var f=A(t);s=E(f,"DIV",{class:!0});var l=A(s);n=E(l,"TEXTAREA",{class:!0,placeholder:!0}),A(n).forEach(p),l.forEach(p),f.forEach(p),this.h()},h(){b(n,"class","textarea textarea-bordered textarea-lg w-full h-full"),b(n,"placeholder","Type here..."),b(s,"class","indicator flex-grow"),b(t,"class","flex w-full mb-4 mt-2")},m(a,f){I(a,t,f),P(t,s),P(s,n),ie(n,r[11]),o||(e=[W(n,"input",r[22]),W(n,"input",r[15])],o=!0)},p(a,f){f[0]&2048&&ie(n,a[11])},d(a){a&&p(t),o=!1,pe(e)}}}function Ve(r){let t,s,n,o;return t=new X({props:{title:"Transfer Files",isOpen:r[12],$$slots:{default:[Ke]},$$scope:{ctx:r}}}),n=new X({props:{title:"Live Clipboard",isOpen:r[12],$$slots:{default:[Me]},$$scope:{ctx:r}}}),{c(){F(t.$$.fragment),s=L(),F(n.$$.fragment)},l(e){H(t.$$.fragment,e),s=B(e),H(n.$$.fragment,e)},m(e,a){U(t,e,a),I(e,s,a),U(n,e,a),o=!0},p(e,a){const f={};a[0]&4096&&(f.isOpen=e[12]),a[0]&9167|a[1]&8&&(f.$$scope={dirty:a,ctx:e}),t.$set(f);const l={};a[0]&4096&&(l.isOpen=e[12]),a[0]&2048|a[1]&8&&(l.$$scope={dirty:a,ctx:e}),n.$set(l)},i(e){o||(R(t.$$.fragment,e),R(n.$$.fragment,e),o=!0)},o(e){N(t.$$.fragment,e),N(n.$$.fragment,e),o=!1},d(e){e&&p(s),Q(t,e),Q(n,e)}}}function qe(r){let t,s,n,o;return t=new X({props:{title:r[12]?"Connected":"Connection",isOpen:!r[12]||!!r[4],$$slots:{default:[Ne]},$$scope:{ctx:r}}}),n=new X({props:{title:r[12]?"Connected: Explore Available Features":"Connect to Access Features",isOpen:r[12],$$slots:{default:[Ve]},$$scope:{ctx:r}}}),{c(){F(t.$$.fragment),s=L(),F(n.$$.fragment)},l(e){H(t.$$.fragment,e),s=B(e),H(n.$$.fragment,e)},m(e,a){U(t,e,a),I(e,s,a),U(n,e,a),o=!0},p(e,a){const f={};a[0]&4096&&(f.title=e[12]?"Connected":"Connection"),a[0]&4112&&(f.isOpen=!e[12]||!!e[4]),a[0]&5168|a[1]&8&&(f.$$scope={dirty:a,ctx:e}),t.$set(f);const l={};a[0]&4096&&(l.title=e[12]?"Connected: Explore Available Features":"Connect to Access Features"),a[0]&4096&&(l.isOpen=e[12]),a[0]&15311|a[1]&8&&(l.$$scope={dirty:a,ctx:e}),n.$set(l)},i(e){o||(R(t.$$.fragment,e),R(n.$$.fragment,e),o=!0)},o(e){N(t.$$.fragment,e),N(n.$$.fragment,e),o=!1},d(e){e&&p(s),Q(t,e),Q(n,e)}}}function ze(r,t,s){let n=le.isEncrypt,o=le.chunkSize,e,a,f=le.iceServer,l="",h=!1,w,D,g=!1,C=!1,K,O="";const T=new URLSearchParams(window.location.search),$=Object.fromEntries(T.entries()),S=$.s;if(S===null||!S)throw window.location.assign(window.location.origin),new Error("no sdp found");const V=$.i;V&&(f=V);const j=$.c;j&&(o=parseInt(j));const i=$.p;i?(n=!0,$e(i).then(_=>{s(3,a=_)})):n=!1;const c=new RTCPeerConnection({iceServers:[{urls:f}]});let v=!1,d;c.ondatachannel=_=>{s(13,d=_.channel),s(13,d.onopen=()=>{G("Connected","success"),s(12,v=!0),K.close()},d),s(13,d.onmessage=z=>{if(typeof z.data=="string"){const y=JSON.parse(z.data);y.type==="clipboard"&&s(11,O=y.data)}else{const y=ve.decode(new Uint8Array(z.data));y.metaData!==void 0?(w.onMetaData(y.id,y.metaData),s(9,C=!0)):y.chunk!==void 0?w.onChunkData(y.id,y.chunk):y.receiveEvent!==void 0&&D.onReceiveEvent(y.id,y.receiveEvent)}},d),s(13,d.onerror=()=>{G("WebRTC error","error"),s(12,v=!1)},d),s(13,d.onclose=()=>{G("Disconnected","error"),s(12,v=!1)},d)};async function J(_){const y={type:"offer",sdp:we(_,!0)};await c.setRemoteDescription(y)}J(S);async function se(){await navigator.clipboard.writeText(l),G("Copied to clipboard","info")}async function ne(){let _="";n&&(s(2,e=await Ce()),_=await ke(e.publicKey)),c.onicecandidate=y=>{!y.candidate&&c.localDescription&&s(4,l=ce(c.localDescription.sdp)+"|"+_)};const z=await c.createAnswer();await c.setLocalDescription(z),setTimeout(async()=>{!c.localDescription||l||(G("Timeout waiting ICE candidates"),s(4,l=ce(c.localDescription.sdp)+"|"+_))},Ee)}ne();function u(_){const z=_.target;s(11,O=z.value),m(O)}function m(_){if(d&&d.readyState==="open"){const z=JSON.stringify({type:"clipboard",data:_});d.send(z)}}const q=_=>{s(5,h=_)};function M(_){ae[_?"unshift":"push"](()=>{K=_,s(10,K)})}const Y=()=>{s(8,g=!0)},Z=()=>{s(9,C=!1),s(8,g=!1)};function x(_){ae[_?"unshift":"push"](()=>{D=_,s(7,D)})}function ee(_){ae[_?"unshift":"push"](()=>{w=_,s(6,w)})}function de(){O=this.value,s(11,O)}return[n,o,e,a,l,h,w,D,g,C,K,O,v,d,se,u,q,M,Y,Z,x,ee,de]}class Fe extends me{constructor(t){super(),_e(this,t,ze,qe,he,{},null,[-1,-1])}}export{Fe as default};
